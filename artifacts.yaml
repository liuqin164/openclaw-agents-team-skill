version: 1.1.0
type: artifact-schema
name: artifact-driven-dev-team-artifacts

description: >
  Artifact protocol definitions for an artifact-driven virtual
  software development team running on OpenClaw.
  Fully aligned with workflow-registry stage transitions.

# =========================
# 1. Global Artifact Rules
# =========================
global:
  default_format: markdown
  allowed_status:
    - draft
    - approved
    - rejected
    - completed

  immutability:
    approved_artifact_readonly: true
    new_version_required_on_change: true

# =========================
# 2. Artifact Definitions
# =========================
artifacts:

  ProjectContext:
    description: >
      项目全局上下文，作为整个流水线的唯一事实源（Single Source of Truth）。
      包含项目名称、物理路径、版本信息等。
    schema:
      ProjectName:
        type: string
        description: 项目名称（用于展示与标识）
      ProjectPath:
        type: string
        description: 项目在文件系统中的绝对路径
      Version:
        type: string
        description: PRD 版本号（如 v1.0 / v1.1）
      CreatedAt:
        type: string
        description: 项目创建时间（ISO8601）

  # -------- Input --------
  RawIdea:
    description: User provided raw product idea
    producer: User
    consumers: [PM]
    status_flow: [draft]

  ChangeRequest:
    description: Requirement change request submitted during development
    producer: User
    consumers: [PM]
    status_flow: [draft, approved, rejected]
    required_sections:
      - 变更背景
      - 新增或修改的需求
      - 变更原因
      - 紧急程度

  # -------- Planning --------
  PRD:
    description: Product Requirement Document
    producer: PM
    consumers: [PJM, UXDesigner, Architect]
    status_flow: [draft, approved, rejected]
    required_sections:
      - Meta
      - 项目背景
      - 项目目标
      - 用户画像
      - 使用场景
      - 功能需求
      - 非功能需求
      - 不在范围内
      - 验收标准

    meta_validation:
      required_fields:
        - PRD 名称
        - PRD 版本
        - PRD 状态
        - 创建日期
        - 创建人（Agent）
        - 所属主线（Track）
        - 上一版本 PRD
        - 变更类型
        - Project Name

  Backlog:
    description: Task backlog derived from PRD
    producer: PJM
    consumers:
      - UXDesigner
      - UIDesigner
      - Architect
      - BackendEngineer
      - FrontendEngineer
      - QA
    status_flow: [draft, approved]

  PlanningStageSummary:
    description: Planning stage completion anchor
    producer: PM
    consumers: [System]
    status_flow: [completed]

  # -------- Design --------
  UserFlow:
    description: User interaction flow definition
    producer: UXDesigner
    consumers: [UIDesigner, Architect]
    status_flow: [draft, approved]

  UIDesignSpec:
    description: UI design specification
    producer: UIDesigner
    consumers: [FrontendEngineer]
    status_flow: [draft, approved]

  APISpec:
    description: API specification
    producer: Architect
    consumers: [BackendEngineer, FrontendEngineer]
    status_flow: [draft, approved]

  DBSchema:
    description: Database schema definition
    producer: Architect
    consumers: [BackendEngineer]
    status_flow: [draft, approved]

  DesignStageSummary:
    description: Design stage completion anchor
    producer: Architect
    consumers: [System]
    status_flow: [completed]

  # -------- Implementation --------
  BackendImplementation:
    description: Backend delivery bound to project backend directory
    producer: BackendEngineer
    consumers: [QA]
    status_flow: [completed]
    binding:
      directory: backend/

  FrontendImplementation:
    description: Frontend delivery bound to project frontend directory
    producer: FrontendEngineer
    consumers: [QA]
    status_flow: [completed]
    binding:
      directory: frontend/

  AgentProgressReport:
    description: Agent progress report for implementation summary aggregation
    producer: BackendEngineer
    consumers: [System]
    status_flow: [completed]

  ImplementationStageSummary:
    description: Implementation stage completion anchor
    producer: BackendEngineer
    consumers: [System]
    status_flow: [completed]

  # -------- QA --------
  TestReport:
    description: QA test and acceptance report
    producer: QA
    consumers: [User, PM]
    status_flow: [draft, approved, rejected]

  BugReport:
    description: Bug report generated during QA
    producer: QA
    consumers: [BackendEngineer, FrontendEngineer]
    status_flow:
      - draft
      - approved
      - fixed
      - closed
