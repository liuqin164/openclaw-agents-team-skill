name: artifact-driven-dev-team
display_name: Artifact-driven Virtual Dev Team

version: 1.0.3  # æ›´æ–°ç‰ˆæœ¬
schema_version: 1.0

description: >
  A reusable, artifact-driven virtual software development team skill.
  It provides a full workflow from product idea to QA acceptance,
  powered by structured agents and document-based orchestration.
  æ–°å¢æ™ºèƒ½é¡¹ç›®æ–‡ä»¶å¤¹åˆ›å»ºåŠŸèƒ½ï¼šåœ¨ PM ç†è§£ç”¨æˆ·éœ€æ±‚åç”Ÿæˆ PRD å‰ï¼Œè‡ªåŠ¨åˆ›å»ºé¡¹ç›®ç›®å½•ï¼Œ
  ç”Ÿæˆ README.md å¹¶è®°å½•æ—¥å¿—ã€‚README è‡ªåŠ¨åŒ…å« PRD æ–‡ä»¶å ä½ç¬¦ã€‚

author: LangGPT
license: MIT

# =========================
# 1. Entry & Core Files
# =========================
entry:
  system_prompt: system_prompt.md
  registry: registry.yaml
  artifacts: artifacts.yaml

# =========================
# 2. Built-in Agents
# =========================
agents:
  builtin:
    - PM
    - PJM
    - UXDesigner
    - UIDesigner
    - Architect
    - BackendEngineer
    - FrontendEngineer
    - QA

  directory: agents/

# =========================
# 3. Agent Template Policy
# =========================
agent_policy:
  builtin_templates: required
  allow_override: true
  override_strategy:
    - full_replace
    - partial_extend

# =========================
# 4. Artifact Policy
# =========================
artifact_policy:
  default_format: markdown
  enforce_schema: true
  versioning:
    enabled: true
    strategy: semver
  immutability:
    approved_readonly: true

# =========================
# 5. Workflow Policy
# =========================
workflow_policy:
  enforce_stage_order: true
  allow_parallel_execution: true
  allow_skip_stage: false
  hooks:
    before_stage:
      PM:
        - name: create_project_folder
          description: >
            åœ¨ PM ç†è§£ç”¨æˆ·éœ€æ±‚åã€ç”Ÿæˆ PRD ä¹‹å‰ï¼Œ
            åœ¨ $HOME/openclaw_workspace/ ä¸‹åˆ›å»ºé¡¹ç›®æ–‡ä»¶å¤¹ï¼Œ
            å¹¶ç”Ÿæˆ README.md å’Œæ“ä½œæ—¥å¿—ã€‚
            README.md è‡ªåŠ¨åŒ…å« PRD æ–‡ä»¶å ä½ç¬¦ã€‚
          action: |
            import os
            import pathlib
            import re
            from datetime import datetime

            # --- é…ç½®å‚æ•° ---
            workspace = os.environ.get("OPENCLAW_WORKSPACE", "~/openclaw_workspace")
            workspace = os.path.expanduser(workspace)

            # è·å–éœ€æ±‚åç§°
            raw_title = input_artifacts.get("RawIdea", {}).get("title", "default_project")
            # æ¸…ç†æ–‡ä»¶å¤¹ä¸å…è®¸çš„å­—ç¬¦
            safe_title = re.sub(r'[\\/:*?"<>| ]', '_', raw_title.strip())
            base_folder_name = f"project-{safe_title}"
            project_path = os.path.join(workspace, base_folder_name)

            # å¦‚æœæ–‡ä»¶å¤¹å·²å­˜åœ¨ï¼Œè‡ªåŠ¨åŠ åºå·
            counter = 1
            final_path = project_path
            while os.path.exists(final_path):
                counter += 1
                final_path = f"{project_path}-{counter}"

            # åˆ›å»ºé¡¹ç›®æ–‡ä»¶å¤¹
            pathlib.Path(final_path).mkdir(parents=True, exist_ok=True)

            # ç”Ÿæˆ README.md
            readme_path = os.path.join(final_path, "README.md")
            with open(readme_path, "w", encoding="utf-8") as f:
                f.write(f"# é¡¹ç›®ç›®å½•: {base_folder_name}\n")
                f.write(f"- åŸå§‹éœ€æ±‚æ ‡é¢˜: {raw_title}\n")
                f.write(f"- åˆ›å»ºæ—¶é—´: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\n\n")
                f.write("## PRD æ–‡ä»¶\n")
                f.write("- å ä½ç¬¦: PRD æ–‡ä»¶å°†åœ¨æ­¤ç›®å½•ç”Ÿæˆï¼Œå¦‚ project_prd.md\n")
                f.write("- ç”Ÿæˆåè¯·æ›¿æ¢æ­¤å ä½ç¬¦ä¸ºå®é™…æ–‡ä»¶è·¯å¾„\n")

            # å†™æ“ä½œæ—¥å¿—
            log_file = os.path.join(workspace, "project_creation.log")
            with open(log_file, "a", encoding="utf-8") as log:
                log.write(f"{datetime.now().strftime('%Y-%m-%d %H:%M:%S')} | åˆ›å»ºé¡¹ç›®æ–‡ä»¶å¤¹: {final_path}\n")

            print(f"âœ… é¡¹ç›®æ–‡ä»¶å¤¹å·²åˆ›å»º: {final_path}")
            print(f"ğŸ“„ README.md å·²ç”Ÿæˆï¼ŒåŒ…å« PRD å ä½ç¬¦")

# =========================
# 6. Runtime Configuration (Optional)
# =========================
runtime:
  configurable:
    - domain_context
    - language
    - tone
  defaults:
    language: zh
    tone: concise
  resume_policy:
    on_restart: continue_from_artifact_state

# =========================
# 7. Compatibility
# =========================
compatibility:
  openclaw_min_version: ">=0.5.0"
  platforms:
    - local
    - cloud
    - embedded

# =========================
# 8. Installation Hooks (Optional)
# =========================
hooks:
  on_install:
    - validate_environment
    - init_artifact_store
  on_uninstall:
    - cleanup_temp_artifacts

# =========================
# 9. Documentation
# =========================
docs:
  readme: README.md
  examples:
    - examples/basic_run.md
    - examples/custom_agent_override.md
